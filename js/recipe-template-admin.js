function doSteps(){jQuery('textarea[id^="gmc-admin-new-step"]').live("focus",function(){var a=this.id.substring(19);var b=parseFloat(jQuery(".gmc-singlestep").length)+1;var c=jQuery("#gmc-steps-step-"+a).html();var d=new RegExp(">[0-9]+</span>","i");c=c.replace(d,">"+b+"</span>");c=c.replace("gmc-admin-new-step-"+a,"gmc-admin-new-step-"+b);c='<div id="gmc-steps-step-'+b+'" class="gmc-singlestep postbox ">'+c+"</div>";jQuery(c).appendTo("#gmc-stepslist");jQuery("#gmc-steps-step-"+b+" textarea.autoResize").autoResize({extraSpace:20,minHeight:32});jQuery("#gmc-admin-new-step-"+a).removeAttr("id")})}function doIngredients(){jQuery('input[id^="gmc-admin-new-ingredient"]').live("focus",function(){var a=this.id.substring(25);var b=parseFloat(jQuery(".gmc-singleingredient").length)+1;var c=jQuery("#gmc-ingredients-ingredient-"+a).html();var d=new RegExp(">[0-9]+</span>","i");c=c.replace(d,">"+b+"</span>");c=c.replace("gmc-admin-new-ingredient-"+a,"gmc-admin-new-ingredient-"+b);var e=new RegExp('id="gmc-recipeingredientorder-'+a+'" type="hidden" value="[0-9]+"',"i");c=c.replace(e,'id="gmc-recipeingredientorder-'+b+'" type="hidden" value="'+b+'"');var f=new RegExp("unique-ingred","g");c=c.replace(f,"unique-ingred1");c='<tr id="gmc-ingredients-ingredient-'+b+'" class="gmc-singleingredient">'+c+"</tr>";var g=new RegExp("color.*;","g");c=c.replace(g,"");jQuery("#ingredientsTable tr:last").after(c);jQuery("#ingredientsTable tr:last").hide().fadeIn();jQuery("#gmc-admin-new-ingredient-"+a).attr("id","")});jQuery(".sortable").bind("sortupdate",function(a,b){jQuery('input[name="gmc-recipeingredientorder[]"]').each(function(a){jQuery(this).val(a+1)})})}function doLoadCorrectTab(){if(jQuery("#recipe-data")[0]){jQuery("#recipe-data").tabs({select:function(a,b){jQuery("#gmc-selected-tab").val(b.tab.hash.substring(1));return true}})}var a=getUrlEncodedKey("gmc-tab");jQuery("#recipe-data").tabs().tabs("select",a);jQuery("#gmc-selected-tab").val(a);var b=getUrlEncodedKey("gmc-add");if(b=="step"){jQuery("#gmc-addstep").show();jQuery("#gmc-show-addstep").hide();jQuery("#gmc-stepslistbox").hide();jQuery("#gmc-step-added").hide().fadeIn(1500)}else if(b=="ingredient"){jQuery("#gmc-addingredient").show();jQuery("#gmc-show-addingredient").hide();jQuery("#gmc-ingredientslistbox").hide();jQuery("#gmc-ingredient-added").hide().fadeIn(1500)}}function doFeaturedImage(){if(jQuery("#postdiv")[0]&&jQuery("#gmc-addstep")[0]){jQuery("#gmc-post-thumbnail").insertBefore("#postdiv")}else if(jQuery("#postdivrich")[0]&&jQuery("#gmc-addstep")[0]){jQuery("#gmc-post-thumbnail").insertBefore("#postdivrich")}}function doPublishHide(){if(jQuery("#gmc-recipe-main")[0]){jQuery("#submitdiv .hndle span").html(saveRecipeMessage);var a=jQuery("#publish").val();if(a=="Publish"){jQuery("#publish").val(saveRecipeMessage)}else if(a=="Update"){jQuery("#publish").val(updateRecipeMessage)}else if(a=="Submit for Review"){jQuery("#publish").val(submitRecipeForReviewMessage)}else if(a=="Schedule"){jQuery("#publish").val(scheduleRecipeForPublishingMessage)}}}function getUrlEncodedKey(a,b){if(!b)b=window.location.search;var c=new RegExp("[?|&]"+a+"=(.*?)&");var d=c.exec(b+"&");if(!d||d.length<2)return"";return decodeURIComponent(d[1].replace("+"," "))}function doResizeTextAreas(){jQuery("textarea.autoResize").autoResize({extraSpace:20,minHeight:32})}function doModifyRichTextEditor(){if(jQuery("#editor-toolbar").length==0){jQuery("#postdivrich").appendTo("#gmc-note-desc");if(jQuery("#gmc-note").length>0){jQuery("#wp-content-media-buttons").remove()}}else{jQuery("#editor-toolbar, #editorcontainer, #post-status-info").appendTo("#gmc-note-desc")}}function doChangeSaveMessages(){if(typeof postPublishedMessage!=="undefined"){jQuery("#message:contains('Post published')").html(postPublishedMessage);jQuery("#message:contains('Post updated')").html(postUpdatedMessage)}}function doLoadInitialRegionDiv(){if(jQuery("#gmc-use-custom-region").val()=="Y"){jQuery("#gmc-standard-region-area").hide()}else{jQuery("#gmc-custom-region-area").hide()}jQuery("#gmc-show-custom-region").click(function(){jQuery("#gmc-use-custom-region").val("Y");jQuery("#gmc-standard-region-area").hide();jQuery("#gmc-custom-region-area").show();return false});jQuery("#gmc-show-standard-region").click(function(){jQuery("#gmc-use-custom-region").val("");jQuery("#gmc-custom-region-area").hide();jQuery("#gmc-standard-region-area").show();return false})}function doLoadInitialMeasurementDiv(){jQuery(".gmc-use-custom-measurement").each(function(){var a=jQuery(this)[0].id.substring(27);if(jQuery(this).val()=="Y"){jQuery("#gmc-standard-measurement-area-"+a).hide()}else{jQuery("#gmc-custom-measurement-area-"+a).hide()}});jQuery(".gmc-show-custom-measurement").live("click",function(){var a=this.id.substring(28);jQuery("#gmc-use-custom-measurement-"+a).val("Y");jQuery("#gmc-standard-measurement-area-"+a).hide();jQuery("#gmc-custom-measurement-area-"+a).show();return false});jQuery(".gmc-show-standard-measurement").live("click",function(){var a=this.id.substring(30);jQuery("#gmc-use-custom-measurement-"+a).val("");jQuery("#gmc-custom-measurement-area-"+a).hide();jQuery("#gmc-standard-measurement-area-"+a).show();return false})}function doConfirmationPrompts(){jQuery(".gmc-delete-ingredient").click(function(){var a=this.id.substring(25);jQuery("#gmc-ingredient-to-delete").val(a);jConfirm(confirmDeleteIngredientMessage,confirmDeleteIngredientTitle,function(a){if(a){jQuery("#post").submit()}});return false});jQuery(".gmc-delete-step").click(function(){var a=this.id.substring(19);jQuery("#gmc-step-to-delete").val(a);jConfirm(confirmDeleteStepMessage,confirmDeleteStepTitle,function(a){if(a){jQuery("#post").submit()}});return false});jQuery("#gmc-reset-css").click(function(){jConfirm(confirmResetCssMessage,confirmResetCssTitle,function(a){if(a){jQuery("#gmc_resetcss").val("Y");jQuery("#save-settings").click()}});return false})}function doLoadInitialSourceDiv(){showSourceDiv();jQuery("#gmc-source-type").change(function(a){showSourceDiv()})}function showSourceDiv(){jQuery("#gmc-source-author, #gmc-source-author-url, #gmc-source-book, #gmc-source-book-url, #gmc-source-mag, #gmc-source-mag-url, #gmc-source-website, #gmc-source-website-url").hide();if(jQuery("#gmc-source-type").val()=="Author"){jQuery("#gmc-source-author, #gmc-source-author-url").show()}else if(jQuery("#gmc-source-type").val()=="Book"){jQuery("#gmc-source-book, #gmc-source-book-url").show()}else if(jQuery("#gmc-source-type").val()=="Magazine"){jQuery("#gmc-source-mag, #gmc-source-mag-url").show()}else if(jQuery("#gmc-source-type").val()=="Website"){jQuery("#gmc-source-website, #gmc-source-website-url").show()}}function doPopulateTextInputHints(){var a="#666";jQuery(".gmc-ingredient-name-hint").each(function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientName).css("color",a)});jQuery(".gmc-ingredient-name-hint").live("focus",function(){if(jQuery(this).val()==ingredientName)jQuery(this).val("").removeAttr("style")});jQuery(".gmc-ingredient-name-hint").live("blur",function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientName).css("color",a)});jQuery(".gmc-ingredient-note-hint").each(function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientNote).css("color",a)});jQuery(".gmc-ingredient-note-hint").live("focus",function(){if(jQuery(this).val()==ingredientNote)jQuery(this).val("").removeAttr("style")});jQuery(".gmc-ingredient-note-hint").live("blur",function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientNote).css("color",a)});jQuery(".gmc-ingredient-quantity-hint").each(function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientQuantity).css("color",a)});jQuery(".gmc-ingredient-quantity-hint").live("focus",function(){if(jQuery(this).val()==ingredientQuantity)jQuery(this).val("").removeAttr("style")});jQuery(".gmc-ingredient-quantity-hint").live("blur",function(){if(jQuery(this).val()=="")jQuery(this).val(ingredientQuantity).css("color",a)});if(jQuery("#gmc-description").val()=="")jQuery("#gmc-description").val(recipeDescription).css("color",a);jQuery("#gmc-description").live("focus",function(){if(jQuery(this).val()==recipeDescription)jQuery(this).val("").removeAttr("style")});jQuery("#gmc-description").live("blur",function(){if(jQuery(this).val()=="")jQuery(this).val(recipeDescription).css("color",a)})}function gmcRemoveStepThumbnail(a,b){jQuery.post(ajaxurl,{action:"set-post-thumbnail",post_id:a,thumbnail_id:-1,_ajax_nonce:b,cookie:encodeURIComponent(document.cookie)},function(b){if(b=="0"){alert(setPostThumbnailL10n.error)}else{jQuery("#gmc-upload-thumbnail-"+a).fadeOut().html();jQuery("#remove-step-thumbnail-"+a).fadeOut().html()}})}jQuery.extend({getIframeUrlVars:function(){var a=[],b;var c=jQuery("#TB_iframeContent").attr("src");if(c.indexOf("#")!=-1){myhref2=c.substr(0,c.indexOf("#"));c=myhref2}var d=c.slice(c.indexOf("?")+1).split("&");for(var e=0;e<d.length;e++){b=d[e].split("=");a.push(b[0]);a[b[0]]=b[1]}return a},getIframeUrlVar:function(a){return jQuery.getIframeUrlVars()[a]}});jQuery(document).ready(function(){doFeaturedImage();doModifyRichTextEditor();doResizeTextAreas();doChangeSaveMessages();doLoadInitialRegionDiv();doLoadInitialMeasurementDiv();doConfirmationPrompts();doLoadCorrectTab();doSteps();doIngredients();doPublishHide();doLoadInitialSourceDiv();doPopulateTextInputHints();if(jQuery("#gmc-shortcodecss").length){var a=CodeMirror.fromTextArea(document.getElementById("gmc-shortcodecss"),{mode:"css",lineNumbers:true})}jQuery("input.colors").miniColors({change:function(a,b){}});jQuery(".chzn-select").chosen();jQuery(".sortable").sortable({items:"tr:not(.ui-state-disabled)"});jQuery("#publish").click(function(){jQuery(this).hide()});jQuery(".gmc-tooltip").tooltip({tipClass:"gmc-tooltip-text"});jQuery("#gmc-insert-recipe-button").click(function(){tinyMCE.activeEditor.execCommand("mceInsertContent",false,"[gmc_recipe "+jQuery("#gmc-insert-recipe-list").val()+"]");tinyMCEPopup.close();return false})})